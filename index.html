<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üç≤ Cocina para Uno - Tu Recetario Personal</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#ef4444">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Cocina para Uno">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="msapplication-TileColor" content="#ef4444">
    <meta name="msapplication-tap-highlight" content="no">
    
    <!-- Description -->
    <meta name="description" content="Tu recetario personal din√°mico para cocineros solitarios">
    
    <!-- Icons -->
    <link rel="icon" type="image/png" sizes="32x32" href="./assets/img/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="./assets/img/favicon-16x16.png">
    <link rel="apple-touch-icon" href="./assets/img/apple-touch-icon.png">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Styles -->
    <link rel="stylesheet" href="./css/styles.css">
</head>
<body>
    <div class="app" id="app">
        <!-- Header -->
        <header class="header">
            <div class="container">
                <div class="header__content">
                    <div class="header__branding">
                        <h1 class="header__title">
                            <span class="header__emoji">üç≤</span>
                            <span class="header__text">Cocina para Uno</span>
                        </h1>
                        <p class="header__subtitle">Tu recetario personal din√°mico</p>
                    </div>
                    
                    <div class="header__stats">
                        <div class="stats">
                            <div class="stats__item">
                                <span class="stats__value" id="total-recipes">0</span>
                                <span class="stats__label">recetas</span>
                            </div>
                            <div class="stats__divider">‚Ä¢</div>
                            <div class="stats__item">
                                <span class="stats__value" id="total-favorites">0</span>
                                <span class="stats__label">favoritas</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="header__actions">
                        <!-- Language Selector -->
                        <div class="language-selector">
                            <button type="button" class="btn btn--ghost btn--small" id="language-btn">
                                <span class="btn__icon">üåç</span>
                                <span class="btn__text" id="current-language">ES</span>
                            </button>
                        </div>
                        
                        <!-- Theme Toggle -->
                        <div class="theme-toggle">
                            <button type="button" class="btn btn--ghost btn--small" id="theme-toggle">
                                <span class="btn__icon" id="theme-icon">‚òÄÔ∏è</span>
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Search Bar -->
                <div class="header__search">
                    <div class="search">
                        <div class="search__input-wrapper">
                            <input 
                                type="text" 
                                id="search-input"
                                class="search__input" 
                                placeholder="Buscar recetas o ingredientes..."
                                autocomplete="off"
                            >
                            <button type="button" class="search__clear" id="search-clear" hidden>
                                <span aria-hidden="true">√ó</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation & Filters -->
        <nav class="nav">
            <div class="container">
                <div class="nav__content">
                    <!-- Filter Buttons -->
                    <div class="nav__filters">
                        <button type="button" class="filter-btn filter-btn--active" data-filter="all" id="filter-all">
                            <span class="filter-btn__text">Todas</span>
                            <span class="filter-btn__count" id="count-all">0</span>
                        </button>
                        <button type="button" class="filter-btn" data-filter="favorites" id="filter-favorites">
                            <span class="filter-btn__text">Favoritas</span>
                            <span class="filter-btn__count" id="count-favorites">0</span>
                        </button>
                        
                        <!-- Categories Dropdown -->
                        <div class="dropdown">
                            <button type="button" class="filter-btn dropdown__trigger" aria-expanded="false" aria-haspopup="true">
                                <span class="filter-btn__text">Categor√≠as</span>
                                <span class="dropdown__arrow">‚ñº</span>
                            </button>
                            <div class="dropdown__menu" id="categories-menu" hidden></div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="nav__actions">
                        <button type="button" class="btn btn--primary" id="add-recipe-btn">
                            <span class="btn__icon">+</span>
                            <span class="btn__text">Nueva Receta</span>
                        </button>
                    </div>
                </div>
                
                <!-- Results Info -->
                <div class="nav__results">
                    <span class="results-count" id="results-count">0 recetas</span>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main class="main">
            <div class="container">
                <!-- Recipe Grid -->
                <div class="recipes-grid" id="recipes-grid" role="grid">
                    <!-- Recipe cards will be inserted here -->
                </div>

                <!-- Empty State -->
                <div class="empty-state" id="empty-state" hidden>
                    <div class="empty-state__content">
                        <div class="empty-state__icon">üçΩÔ∏è</div>
                        <h2 class="empty-state__title">No hay recetas</h2>
                        <p class="empty-state__message">¬°Agrega tu primera receta para empezar!</p>
                        <button type="button" class="btn btn--primary empty-state__btn" onclick="app.showRecipeForm()">
                            <span class="btn__icon">+</span>
                            <span class="btn__text">Crear Primera Receta</span>
                        </button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Recipe Form Modal -->
        <dialog class="modal" id="recipe-modal">
            <div class="modal__backdrop"></div>
            <div class="modal__container">
                <form class="modal__form" id="recipe-form">
                    <header class="modal__header">
                        <h2 class="modal__title" id="form-title">Nueva Receta</h2>
                        <button type="button" class="modal__close" aria-label="Cerrar">
                            <span aria-hidden="true">√ó</span>
                        </button>
                    </header>
                    
                    <div class="modal__body">
                        <!-- Recipe Name -->
                        <div class="form-group">
                            <label for="recipe-name" class="form-label">Nombre de la receta</label>
                            <input 
                                type="text" 
                                id="recipe-name" 
                                class="form-input" 
                                placeholder="Ej: Arepas con queso"
                                required
                            >
                        </div>

                        <!-- Basic Info Row -->
                        <div class="form-row">
                            <div class="form-group">
                                <label for="recipe-time" class="form-label">Tiempo (min)</label>
                                <input 
                                    type="number" 
                                    id="recipe-time" 
                                    class="form-input" 
                                    placeholder="30"
                                    min="1"
                                    max="480"
                                    required
                                >
                            </div>
                            <div class="form-group">
                                <label for="recipe-servings" class="form-label">Porciones</label>
                                <input 
                                    type="number" 
                                    id="recipe-servings" 
                                    class="form-input" 
                                    placeholder="1"
                                    min="1"
                                    max="20"
                                    value="1"
                                >
                            </div>
                            <div class="form-group">
                                <label for="recipe-difficulty" class="form-label">Dificultad</label>
                                <select id="recipe-difficulty" class="form-select">
                                    <option value="F√°cil">F√°cil</option>
                                    <option value="Medio">Medio</option>
                                    <option value="Dif√≠cil">Dif√≠cil</option>
                                </select>
                            </div>
                        </div>

                        <!-- Rating -->
                        <div class="form-group">
                            <label class="form-label">Tu calificaci√≥n</label>
                            <div class="rating-input" id="rating-input">
                                <button type="button" class="star" data-rating="1">‚òÖ</button>
                                <button type="button" class="star" data-rating="2">‚òÖ</button>
                                <button type="button" class="star" data-rating="3">‚òÖ</button>
                                <button type="button" class="star" data-rating="4">‚òÖ</button>
                                <button type="button" class="star active" data-rating="5">‚òÖ</button>
                            </div>
                            <input type="hidden" id="manual-rating" value="5">
                        </div>

                        <!-- Ingredients -->
                        <div class="form-group">
                            <label class="form-label">Ingredientes</label>
                            <div class="dynamic-list" id="ingredients-list">
                                <!-- Dynamic ingredient inputs will be added here -->
                            </div>
                            <button type="button" class="btn btn--outline btn--add-ingredient">
                                <span class="btn__icon">+</span>
                                <span class="btn__text">Agregar Ingrediente</span>
                            </button>
                        </div>

                        <!-- Steps -->
                        <div class="form-group">
                            <label class="form-label">Pasos de preparaci√≥n</label>
                            <div class="dynamic-list" id="steps-list">
                                <!-- Dynamic step inputs will be added here -->
                            </div>
                            <button type="button" class="btn btn--outline btn--add-step">
                                <span class="btn__icon">+</span>
                                <span class="btn__text">Agregar Paso</span>
                            </button>
                        </div>

                        <!-- Categories -->
                        <div class="form-group">
                            <label for="category-input" class="form-label">Categor√≠as</label>
                            <input 
                                type="text" 
                                id="category-input" 
                                class="form-input" 
                                placeholder="Presiona Enter para agregar categor√≠a"
                            >
                            <div class="categories-list" id="categories-list">
                                <!-- Categories will be added here -->
                            </div>
                        </div>

                        <!-- Notes -->
                        <div class="form-group">
                            <label for="recipe-notes" class="form-label">Notas personales (opcional)</label>
                            <textarea 
                                id="recipe-notes" 
                                class="form-textarea" 
                                placeholder="A√±ade cualquier nota, consejo o modificaci√≥n..."
                                rows="3"
                            ></textarea>
                        </div>

                        <!-- Image Upload -->
                        <div class="form-group">
                            <label for="recipe-image" class="form-label">Imagen (opcional)</label>
                            <input 
                                type="file" 
                                id="recipe-image" 
                                class="form-input-file" 
                                accept="image/*"
                            >
                            <div class="image-preview" id="image-preview" hidden>
                                <img class="image-preview__img" alt="Preview" loading="lazy">
                                <button type="button" class="image-preview__remove">√ó</button>
                            </div>
                        </div>
                    </div>
                    
                    <footer class="modal__footer">
                        <button type="button" class="btn btn--secondary" onclick="this.closest('dialog').close()">
                            Cancelar
                        </button>
                        <button type="submit" class="btn btn--primary">
                            <span class="btn__icon">üíæ</span>
                            <span class="btn__text">Guardar Receta</span>
                        </button>
                    </footer>
                </form>
            </div>
        </dialog>

        <!-- Recipe Detail Modal -->
        <dialog class="modal modal--recipe-detail" id="recipe-detail-modal">
            <div class="modal__backdrop"></div>
            <div class="modal__container">
                <div class="modal__content">
                    <!-- Recipe detail content will be inserted here -->
                </div>
            </div>
        </dialog>

        <!-- Toast Container -->
        <div class="toast-container" id="toast-container"></div>
    </div>

    <!-- Scripts -->
    <script type="module" src="./js/objects.js"></script>
    <script type="module" src="./js/patterns.js"></script>
    <script type="module" src="./js/main.js"></script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => console.log('SW registered'))
                    .catch(error => console.log('SW registration failed'));
            });
        }
    </script>
</body>
</html>
